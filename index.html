<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Multi-Platform Account Help Center</title>
    <script src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        :root {
            --primary-color: #4285f4;
            --secondary-color: #f1f8fe;
            --accent-color: #34a853;
            --error-color: #ea4335;
            --text-color: #333;
            --light-text: #777;
            --border-color: #ddd;
            --white: #ffffff;
            --shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: #f9f9f9;
            color: var(--text-color);
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            background-color: var(--white);
            box-shadow: var(--shadow);
            padding: 20px 0;
            border-radius: 10px;
            margin-bottom: 30px;
            text-align: center;
            position: relative;
        }

        .logo {
            font-size: 2.5rem;
            color: var(--primary-color);
            margin-bottom: 10px;
        }

        .tagline {
            color: var(--light-text);
            font-size: 1.1rem;
            margin-bottom: 20px;
        }

        .language-selector {
            position: absolute;
            top: 20px;
            right: 20px;
        }

        .language-selector select {
            padding: 8px 12px;
            border-radius: 5px;
            border: 1px solid var(--border-color);
            background-color: var(--white);
            color: var(--text-color);
            cursor: pointer;
        }

        .main-content {
            display: flex;
            flex-wrap: wrap;
            gap: 30px;
        }

        .info-section {
            flex: 1;
            min-width: 300px;
            background-color: var(--white);
            padding: 25px;
            border-radius: 10px;
            box-shadow: var(--shadow);
        }

        .form-section {
            flex: 2;
            min-width: 300px;
            background-color: var(--white);
            padding: 25px;
            border-radius: 10px;
            box-shadow: var(--shadow);
        }

        h1, h2, h3 {
            color: var(--primary-color);
            margin-bottom: 15px;
        }

        .platform-icons {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin: 20px 0;
            justify-content: center;
        }

        .platform-icon {
            font-size: 2.5rem;
            color: var(--primary-color);
            transition: transform 0.3s;
        }

        .platform-icon:hover {
            transform: scale(1.1);
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
        }

        select, input, textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid var(--border-color);
            border-radius: 5px;
            font-size: 1rem;
            transition: border 0.3s;
        }

        select:focus, input:focus, textarea:focus {
            border-color: var(--primary-color);
            outline: none;
        }

        textarea {
            min-height: 120px;
            resize: vertical;
        }

        .btn {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: background-color 0.3s;
            width: 100%;
        }

        .btn:hover {
            background-color: #3367d6;
        }

        .btn:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
        }

        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: var(--white);
            animation: spin 1s ease-in-out infinite;
            margin-right: 10px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .alert {
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
            display: none;
        }

        .alert-success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .alert-error {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .alert-warning {
            background-color: #fff3cd;
            color: #856404;
            border: 1px solid #ffeeba;
        }

        .upload-area {
            border: 2px dashed var(--border-color);
            border-radius: 5px;
            padding: 20px;
            text-align: center;
            margin-bottom: 20px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .upload-area:hover {
            border-color: var(--primary-color);
            background-color: var(--secondary-color);
        }

        .upload-area i {
            font-size: 2rem;
            color: var(--primary-color);
            margin-bottom: 10px;
        }

        .file-name {
            margin-top: 10px;
            font-size: 0.9rem;
            color: var(--light-text);
        }

        .hidden {
            display: none;
        }

        footer {
            text-align: center;
            margin-top: 50px;
            padding: 20px;
            color: var(--light-text);
            font-size: 0.9rem;
        }

        /* Template Styles */
        .template-section {
            margin: 25px 0;
            border: 1px solid var(--border-color);
            border-radius: 5px;
            padding: 15px;
            background-color: var(--secondary-color);
        }
        
        .template-options {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        
        .template-option {
            background-color: var(--white);
            border: 1px solid var(--border-color);
            padding: 15px;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .template-option:hover {
            border-color: var(--primary-color);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
        
        .template-option h4 {
            color: var(--primary-color);
            margin-bottom: 8px;
        }
        
        .template-option p {
            font-size: 0.9rem;
            color: var(--light-text);
            margin-bottom: 10px;
        }
        
        .template-option small {
            display: block;
            font-size: 0.8rem;
            color: var(--accent-color);
            margin-top: 5px;
        }
        
        .selected-template {
            background-color: var(--secondary-color);
            border: 2px solid var(--primary-color);
            box-shadow: 0 0 0 2px rgba(66, 133, 244, 0.3);
        }

        .rate-limit-info {
            font-size: 0.9rem;
            color: var(--light-text);
            text-align: center;
            margin-top: 10px;
        }

        @media (max-width: 768px) {
            .main-content {
                flex-direction: column;
            }
            
            .language-selector {
                position: static;
                margin-bottom: 20px;
                text-align: center;
            }
            
            .template-options {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="language-selector">
                <select id="languageSelect">
                    <option value="en">English</option>
                    <option value="id">Bahasa Indonesia</option>
                    <option value="es">Español</option>
                    <option value="fr">Français</option>
                    <option value="pt">Português</option>
                </select>
            </div>
            <div class="logo">
                <i class="fas fa-life-ring"></i> AccountHelp
            </div>
            <p class="tagline" id="taglineText">Multi-platform account support center</p>
        </header>

        <div class="main-content">
            <section class="info-section">
                <h2 id="infoTitle">How Can We Help?</h2>
                <p id="infoDescription">Our team specializes in helping users recover access to their accounts across various platforms. Select your platform and issue type to get started.</p>
                
                <div class="platform-icons">
                    <i class="fab fa-whatsapp platform-icon" title="WhatsApp"></i>
                    <i class="fab fa-tiktok platform-icon" title="TikTok"></i>
                    <i class="fab fa-telegram platform-icon" title="Telegram"></i>
                    <i class="fab fa-instagram platform-icon" title="Instagram"></i>
                    <i class="fab fa-facebook platform-icon" title="Facebook"></i>
                    <i class="fab fa-twitter platform-icon" title="Twitter"></i>
                    <i class="fab fa-youtube platform-icon" title="YouTube"></i>
                </div>

                <h3 id="quickTitle">Quick Solutions</h3>
                <ul id="quickSolutions">
                    <li>Account recovery</li>
                    <li>Unban requests</li>
                    <li>Login issues</li>
                    <li>Spam reports</li>
                    <li>Security concerns</li>
                </ul>
            </section>

            <section class="form-section">
                <h2 id="formTitle">Report an Issue</h2>
                <div class="alert alert-success" id="successAlert">
                    Your report has been submitted successfully! We'll contact you soon.
                </div>
                <div class="alert alert-error" id="errorAlert">
                    There was an error submitting your report. Please try again.
                </div>
                <div class="alert alert-warning" id="rateLimitAlert">
                    You've reached the daily submission limit (3 reports per day). Please try again tomorrow.
                </div>

                <form id="reportForm">
                    <div class="form-group">
                        <label for="platform" id="platformLabel">Platform</label>
                        <select id="platform" required>
                            <option value="" selected disabled id="selectPlatform">Select a platform</option>
                            <option value="whatsapp">WhatsApp</option>
                            <option value="tiktok">TikTok</option>
                            <option value="telegram">Telegram</option>
                            <option value="instagram">Instagram</option>
                            <option value="facebook">Facebook</option>
                            <option value="twitter">Twitter (X)</option>
                            <option value="youtube">YouTube</option>
                            <option value="discord">Discord</option>
                            <option value="snapchat">Snapchat</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="accountId" id="accountIdLabel">Account ID/Number</label>
                        <input type="text" id="accountId" required placeholder="e.g. +628123456789 or username@example.com">
                    </div>

                    <div class="form-group">
                        <label for="issueType" id="issueTypeLabel">Issue Type</label>
                        <select id="issueType" required>
                            <option value="" selected disabled id="selectIssue">Select an issue type</option>
                            <option value="unban">Account Banned/Unban Request</option>
                            <option value="blocked">Account Blocked</option>
                            <option value="login">Can't Login</option>
                            <option value="spam">Marked as Spam</option>
                            <option value="hacked">Account Hacked</option>
                            <option value="disabled">Account Disabled</option>
                            <option value="verification">Verification Problem</option>
                            <option value="report_user">Report Another User</option>
                            <option value="other">Other Issue</option>
                        </select>
                    </div>

                    <!-- Template Section -->
                    <div class="template-section" id="templateSection" style="display: none;">
                        <h3 id="templateTitle">Select Report Template</h3>
                        <p id="templateDesc">Choose a pre-written template for your issue:</p>
                        <div class="template-options" id="templateOptions">
                            <!-- Templates will be loaded here -->
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="issueDetails" id="issueDetailsLabel">Issue Details</label>
                        <textarea id="issueDetails" required placeholder="Describe your issue in detail..."></textarea>
                    </div>

                    <div class="form-group">
                        <label for="email" id="emailLabel">Your Active Email</label>
                        <input type="email" id="email" required placeholder="your@email.com">
                    </div>

                    <div class="form-group">
                        <div class="upload-area" id="uploadArea">
                            <i class="fas fa-cloud-upload-alt"></i>
                            <p id="uploadText">Click to upload screenshots or proof (optional)</p>
                            <input type="file" id="fileInput" class="hidden" accept="image/*">
                            <p class="file-name" id="fileName"></p>
                        </div>
                    </div>

                    <button type="submit" class="btn" id="submitBtn">
                        <span id="submitText">Submit Report</span>
                    </button>
                    <p class="rate-limit-info" id="rateLimitInfo">Daily submission limit: 3 reports per device</p>
                </form>
            </section>
        </div>

        <footer>
            <p id="footerText">© 2025 AccountHelp Center. All rights reserved.</p>
        </footer>
    </div>

    <script>
        // Initialize Firebase (replace with your config)
        const firebaseConfig = {
            apiKey: "AIzaSyAQVIvZvxmYdcriHR8j0ormGzNRjGD0_no",
           authDomain: "online--suit.firebaseapp.com",
          databaseURL: "https://online--suit-default-rtdb.firebaseio.com",
          projectId: "online--suit",
          storageBucket: "online--suit.firebasestorage.app",
           messagingSenderId: "463840835705",
          appId: "1:463840835705:web:f490fd49851c0afb8dfca8"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();
        const auth = firebase.auth();

        // Initialize EmailJS (replace with your actual credentials)
        emailjs.init('g_hW3EbcT_Z7Ec7Mg');

        // Platform email mapping
        const platformEmails = {
            whatsapp: "support@whatsapp.com",
            tiktok: "legal@tiktok.com",
            telegram: "support@telegram.org",
            instagram: "support@instagram.com",
            facebook: "support@facebook.com",
            twitter: "support@twitter.com",
            youtube: "support@youtube.com",
            discord: "support@discord.com",
            snapchat: "support@snapchat.com"
        };

        // Template database for each platform and language
        const platformTemplates = {
            whatsapp: {
                en: {
                    unban: {
                        title: "Wrongful Ban Appeal",
                        description: "For accounts banned by mistake",
                        content: "Dear WhatsApp Support Team,\n\nMy WhatsApp account with number {accountId} has been banned, and I strongly believe this was a mistake. I have carefully reviewed the Terms of Service and I am confident that I have not violated any policies.\n\nThis account is crucial for my daily communication. I kindly request a formal review of this ban and the reinstatement of my account.\n\nThank you for your time and consideration.\n\nBest regards,\n{email}",
                        responseTime: "Usually 1-3 business days"
                    },
                    hacked: {
                        title: "Hacked Account Report",
                        description: "For compromised accounts",
                        content: "URGENT: Hacked Account Report\n\nDear WhatsApp Security Team,\n\nMy WhatsApp account ({accountId}) has been compromised. I have lost access, and I suspect unauthorized activity is being conducted. Please take immediate action to secure the account and help me regain control.\n\nI can provide any necessary information to verify my identity. Please guide me through the recovery process.\n\nSincerely,\n{email}",
                        responseTime: "Priority response within 24 hours"
                    },
                    report_user: {
                        title: "Report User for Violation",
                        description: "Report another user for spam, harassment, or other violations.",
                        content: "Dear WhatsApp Moderation Team,\n\nI am writing to report the user with the number {reportedAccountId} for violating WhatsApp's policies. \n\n[Please describe the violation here, e.g., spamming, harassment, sharing inappropriate content, etc.]\n\nI have attached screenshots as evidence. I trust you will take appropriate action to maintain the safety of the platform.\n\nThank you for your attention to this matter.\n\nRegards,\n{email}",
                        responseTime: "1-2 business days"
                    }
                },
                id: {
                    unban: {
                        title: "Permohonan Pembukaan Blokir",
                        description: "Untuk akun yang diblokir karena kesalahan",
                        content: "Kepada Tim Dukungan WhatsApp,\n\nAkun WhatsApp saya dengan nomor {accountId} telah diblokir, dan saya yakin ini adalah sebuah kesalahan. Saya telah meninjau Ketentuan Layanan dan yakin tidak ada kebijakan yang saya langgar.\n\nAkun ini sangat penting untuk komunikasi saya. Mohon tinjau kembali pemblokiran ini dan aktifkan kembali akun saya.\n\nTerima kasih atas perhatian Anda.\n\nHormat saya,\n{email}",
                        responseTime: "Biasanya 1-3 hari kerja"
                    },
                    report_user: {
                        title: "Laporan Pelanggaran Pengguna",
                        description: "Laporkan pengguna lain karena spam, pelecehan, atau pelanggaran lainnya.",
                        content: "Kepada Tim Moderasi WhatsApp,\n\nSaya ingin melaporkan pengguna dengan nomor {reportedAccountId} karena telah melanggar kebijakan WhatsApp.\n\n[Silakan jelaskan pelanggarannya di sini, contoh: spam, pelecehan, konten tidak pantas, dll.]\n\nSaya telah melampirkan bukti tangkapan layar. Saya percaya Anda akan mengambil tindakan yang sesuai untuk menjaga keamanan platform.\n\nTerima kasih.\n\nHormat saya,\n{email}",
                        responseTime: "1-2 hari kerja"
                    }
                }
            },
            instagram: {
                en: {
                    unban: {
                        title: "Disabled Account Appeal",
                        description: "For deactivated Instagram accounts",
                        content: "Dear Instagram Support,\n\nMy Instagram account @{accountId} has been disabled, and I am certain this was an error. I have not violated any community guidelines.\n\nThis account is vital for my personal and professional life. Please conduct a thorough review and restore my account. I am prepared to provide any verification necessary.\n\nThank you,\n{email}",
                        responseTime: "3-5 business days"
                    },
                    report_user: {
                        title: "Report User for Violation",
                        description: "Report another user for policy violations.",
                        content: "Dear Instagram Moderation Team,\n\nI am reporting the user @{reportedAccountId} for violating Instagram's community guidelines. \n\n[Please describe the violation, e.g., harassment, hate speech, impersonation, etc.]\n\nThis behavior is harmful to the community. I have attached evidence for your review. Please take swift action.\n\nRegards,\n{email}",
                        responseTime: "1-3 business days"
                    }
                }
            },
            facebook: {
                en: {
                    unban: {
                        title: "Disabled Account Appeal",
                        description: "For deactivated Facebook accounts",
                        content: "Dear Facebook Support,\n\nMy Facebook account ({accountId}) has been disabled. I believe this was a mistake as I have always adhered to the Community Standards.\n\nThis account is my primary way of connecting with family and friends. I request an urgent review of this decision to restore my access.\n\nSincerely,\n{email}",
                        responseTime: "3-7 business days"
                    },
                    report_user: {
                        title: "Report User for Violation",
                        description: "Report another user for policy violations.",
                        content: "Dear Facebook Moderation Team,\n\nI need to report a user with the profile URL/ID: {reportedAccountId} for violating Facebook's Community Standards.\n\n[Please specify the violation, e.g., bullying, fake account, inappropriate content.]\n\nI have gathered evidence (screenshots) and request that you investigate this matter to ensure platform safety.\n\nThank you,\n{email}",
                        responseTime: "2-4 business days"
                    }
                }
            },
            twitter: {
                en: {
                    unban: {
                        title: "Suspended Account Appeal",
                        description: "For suspended Twitter accounts",
                        content: "Dear Twitter Support,\n\nMy Twitter account @{accountId} has been suspended, and I believe this was an error. I have reviewed Twitter's rules and am confident I have not violated them.\n\nPlease review my case and reinstate my account. If I have made an unintentional mistake, I would appreciate clarification.\n\nThank you,\n{email}",
                        responseTime: "2-5 business days"
                    },
                    report_user: {
                        title: "Report User for Violation",
                        description: "Report another user for rule violations.",
                        content: "To Twitter Safety Team,\n\nI am reporting the user @{reportedAccountId} for violating Twitter's rules.\n\n[Please specify the violation, e.g., spam, targeted harassment, hateful conduct.]\n\nThis user's behavior is negatively impacting the platform. Please investigate and take appropriate action.\n\nThank you,\n{email}",
                        responseTime: "1-3 business days"
                    }
                }
            },
            tiktok: {
                en: {
                    unban: {
                        title: "Account Ban Appeal",
                        description: "For banned TikTok accounts",
                        content: "Dear TikTok Support Team,\n\nMy TikTok account @{accountId} has been banned. I have reviewed the Community Guidelines and believe this action was taken in error, as my content complies with all rules.\n\nPlease reconsider this decision and restore my account.\n\nBest regards,\n{email}",
                        responseTime: "3-5 business days"
                    },
                    report_user: {
                        title: "Report User for Violation",
                        description: "Report another user for guideline violations.",
                        content: "Dear TikTok Moderation Team,\n\nI am reporting user @{reportedAccountId} for violating Community Guidelines.\n\n[Please describe the violation, e.g., dangerous acts, harassment, hateful content.]\n\nI am concerned about this user's impact on the community and request a review of their account.\n\nThank you,\n{email}",
                        responseTime: "2-4 business days"
                    }
                }
            },
            youtube: {
                en: [
                    {
                        title: "Terminated Channel Appeal",
                        description: "For terminated YouTube channels",
                        content: "YouTube Support Team,\n\nMy YouTube channel ({accountId}) has been terminated unexpectedly. I believe this was done in error as I haven't violated YouTube's Terms of Service or Community Guidelines.\n\nThis channel represents years of work and is very important to me. Please review my case and restore my channel. I'm happy to provide any additional information needed.\n\nSincerely,\n{email}",
                        responseTime: "3-7 business days"
                    }
                ]
            }
        };

        // Language translations for UI elements
        const translations = {
            en: {
                taglineText: "Multi-platform account support center",
                infoTitle: "How Can We Help?",
                infoDescription: "Our team specializes in helping users recover access to their accounts across various platforms. Select your platform and issue type to get started.",
                quickTitle: "Quick Solutions",
                quickSolutions: [
                    "Account recovery",
                    "Unban requests",
                    "Login issues",
                    "Spam reports",
                    "Security concerns"
                ],
                formTitle: "Report an Issue",
                platformLabel: "Platform",
                selectPlatform: "Select a platform",
                accountIdLabel: "Account ID/Number",
                issueTypeLabel: "Issue Type",
                selectIssue: "Select an issue type",
                issueDetailsLabel: "Issue Details",
                emailLabel: "Your Active Email",
                uploadText: "Click to upload screenshots or proof (optional)",
                templateTitle: "Select Report Template",
                templateDesc: "Choose a pre-written template for your issue:",
                submitText: "Submit Report",
                footerText: "© 2023 AccountHelp Center. All rights reserved.",
                successMessage: "Your report has been submitted successfully! We'll contact you soon.",
                errorMessage: "There was an error submitting your report. Please try again.",
                rateLimitMessage: "You've reached the daily submission limit (3 reports per day). Please try again tomorrow.",
                loadingText: "Sending...",
                rateLimitInfo: "Daily submission limit: 3 reports per device"
            },
            id: {
                taglineText: "Pusat bantuan akun multi-platform",
                infoTitle: "Bagaimana Kami Bisa Membantu?",
                infoDescription: "Tim kami khusus membantu pengguna mendapatkan kembali akses ke akun mereka di berbagai platform. Pilih platform dan jenis masalah untuk memulai.",
                quickTitle: "Solusi Cepat",
                quickSolutions: [
                    "Pemulihan akun",
                    "Permohonan unban",
                    "Masalah login",
                    "Laporan spam",
                    "Masalah keamanan"
                ],
                formTitle: "Laporkan Masalah",
                platformLabel: "Platform",
                selectPlatform: "Pilih platform",
                accountIdLabel: "ID/Nomor Akun",
                issueTypeLabel: "Jenis Masalah",
                selectIssue: "Pilih jenis masalah",
                issueDetailsLabel: "Detail Masalah",
                emailLabel: "Email Aktif Anda",
                uploadText: "Klik untuk mengunggah screenshot atau bukti (opsional)",
                templateTitle: "Pilih Template Laporan",
                templateDesc: "Pilih template yang sudah dibuat untuk masalah Anda:",
                submitText: "Kirim Laporan",
                footerText: "© 2023 Pusat Bantuan Akun. Semua hak dilindungi.",
                successMessage: "Laporan Anda berhasil dikirim! Kami akan segera menghubungi Anda.",
                errorMessage: "Terjadi kesalahan saat mengirim laporan. Silakan coba lagi.",
                rateLimitMessage: "Anda telah mencapai batas pengiriman harian (3 laporan per hari). Silakan coba lagi besok.",
                loadingText: "Mengirim...",
                rateLimitInfo: "Batas pengiriman harian: 3 laporan per perangkat"
            },
            es: {
                taglineText: "Centro de soporte para cuentas multi-plataforma",
                infoTitle: "¿Cómo podemos ayudarte?",
                infoDescription: "Nuestro equipo está especializado en ayudar a los usuarios a recuperar el acceso a sus cuentas en varias plataformas. Selecciona tu plataforma y tipo de problema para comenzar.",
                quickTitle: "Soluciones rápidas",
                quickSolutions: [
                    "Recuperación de cuenta",
                    "Solicitudes de desbloqueo",
                    "Problemas de inicio de sesión",
                    "Reportes de spam",
                    "Problemas de seguridad"
                ],
                formTitle: "Reportar un problema",
                platformLabel: "Plataforma",
                selectPlatform: "Selecciona una plataforma",
                accountIdLabel: "ID/Número de cuenta",
                issueTypeLabel: "Tipo de problema",
                selectIssue: "Selecciona un tipo de problema",
                issueDetailsLabel: "Detalles del problema",
                emailLabel: "Tu correo electrónico activo",
                uploadText: "Haz clic para subir capturas de pantalla o pruebas (opcional)",
                templateTitle: "Seleccionar plantilla de reporte",
                templateDesc: "Elige una plantilla preescrita para tu problema:",
                submitText: "Enviar reporte",
                footerText: "© 2023 Centro de Ayuda para Cuentas. Todos los derechos reservados.",
                successMessage: "¡Tu reporte ha sido enviado con éxito! Nos pondremos en contacto contigo pronto.",
                errorMessage: "Hubo un error al enviar tu reporte. Por favor inténtalo de nuevo.",
                rateLimitMessage: "Has alcanzado el límite diario de envíos (3 reportes por día). Por favor inténtalo de nuevo mañana.",
                loadingText: "Enviando...",
                rateLimitInfo: "Límite diario de envíos: 3 reportes por dispositivo"
            },
            fr: {
                taglineText: "Centre d'assistance multi-plateformes pour comptes",
                infoTitle: "Comment pouvons-nous vous aider?",
                infoDescription: "Notre équipe est spécialisée dans l'aide aux utilisateurs pour récupérer l'accès à leurs comptes sur diverses plateformes. Sélectionnez votre plateforme et le type de problème pour commencer.",
                quickTitle: "Solutions rapides",
                quickSolutions: [
                    "Récupération de compte",
                    "Demandes de déblocage",
                    "Problèmes de connexion",
                    "Signalements de spam",
                    "Problemes de sécurité"
                ],
                formTitle: "Signaler un problème",
                platformLabel: "Plateforme",
                selectPlatform: "Sélectionnez une plateforme",
                accountIdLabel: "ID/Numéro de compte",
                issueTypeLabel: "Type de problème",
                selectIssue: "Sélectionnez un type de problème",
                issueDetailsLabel: "Détails du problème",
                emailLabel: "Votre email actif",
                uploadText: "Cliquez pour télécharger des captures d'écran ou preuves (optionnel)",
                templateTitle: "Sélectionner un modèle de rapport",
                templateDesc: "Choisissez un modèle pré-écrit pour votre problème:",
                submitText: "Envoyer le rapport",
                footerText: "© 2023 Centre d'Aide aux Comptes. Tous droits réservés.",
                successMessage: "Votre rapport a été envoyé avec succès! Nous vous contacterons bientôt.",
                errorMessage: "Une erreur s'est produite lors de l'envoi de votre rapport. Veuillez réessayer.",
                rateLimitMessage: "Vous avez atteint la limite d'envoi quotidienne (3 rapports par jour). Veuillez réessayer demain.",
                loadingText: "Envoi en cours...",
                rateLimitInfo: "Limite d'envoi quotidienne: 3 rapports par appareil"
            },
            pt: {
                taglineText: "Centro de suporte para contas multi-plataforma",
                infoTitle: "Como podemos ajudar?",
                infoDescription: "Nossa equipe é especializada em ajudar usuários a recuperar o acesso às suas contas em várias plataformas. Selecione sua plataforma e tipo de problema para começar.",
                quickTitle: "Soluções rápidas",
                quickSolutions: [
                    "Recuperação de conta",
                    "Solicitações de desbanimento",
                    "Problemas de login",
                    "Relatórios de spam",
                    "Problemas de segurança"
                ],
                formTitle: "Relatar um problema",
                platformLabel: "Plataforma",
                selectPlatform: "Selecione uma plataforma",
                accountIdLabel: "ID/Número da conta",
                issueTypeLabel: "Tipo de problema",
                selectIssue: "Selecione um tipo de problema",
                issueDetailsLabel: "Detalhes do problema",
                emailLabel: "Seu email ativo",
                uploadText: "Clique para enviar screenshots ou provas (opcional)",
                templateTitle: "Selecionar modelo de relatório",
                templateDesc: "Escolha um modelo pré-escrito para o seu problema:",
                submitText: "Enviar relatório",
                footerText: "© 2023 Centro de Ajuda para Contas. Todos os direitos reservados.",
                successMessage: "Seu relatório foi enviado com sucesso! Entraremos em contato em breve.",
                errorMessage: "Ocorreu um erro ao enviar seu relatório. Por favor, tente novamente.",
                rateLimitMessage: "Você atingiu o limite diário de envios (3 relatórios por dia). Por favor, tente novamente amanhã.",
                loadingText: "Enviando...",
                rateLimitInfo: "Limite diário de envios: 3 relatórios por dispositivo"
            }
        };

        // DOM elements
        const languageSelect = document.getElementById('languageSelect');
        const form = document.getElementById('reportForm');
        const platformSelect = document.getElementById('platform');
        const issueTypeSelect = document.getElementById('issueType');
        const issueDetails = document.getElementById('issueDetails');
        const templateSection = document.getElementById('templateSection');
        const templateOptions = document.getElementById('templateOptions');
        const uploadArea = document.getElementById('uploadArea');
        const fileInput = document.getElementById('fileInput');
        const fileName = document.getElementById('fileName');
        const submitBtn = document.getElementById('submitBtn');
        const submitText = document.getElementById('submitText');
        const successAlert = document.getElementById('successAlert');
        const errorAlert = document.getElementById('errorAlert');
        const rateLimitAlert = document.getElementById('rateLimitAlert');
        const rateLimitInfo = document.getElementById('rateLimitInfo');

        // Current language
        let currentLanguage = 'en';
        let selectedTemplate = null;
        let deviceId = null;
        let submissionCount = 0;
        const MAX_SUBMISSIONS_PER_DAY = 3;

        // Generate a unique device ID (simplified version)
        function generateDeviceId() {
            if (!deviceId) {
                deviceId = localStorage.getItem('deviceId');
                if (!deviceId) {
                    deviceId = 'device_' + Math.random().toString(36).substr(2, 9);
                    localStorage.setItem('deviceId', deviceId);
                }
            }
            return deviceId;
        }

        // Check submission count for current device
        async function checkSubmissionLimit() {
            const deviceId = generateDeviceId();
            const today = new Date().toISOString().split('T')[0]; // YYYY-MM-DD
            
            try {
                const docRef = db.collection('submissions').doc(deviceId);
                const doc = await docRef.get();
                
                if (doc.exists) {
                    const data = doc.data();
                    if (data.date === today) {
                        submissionCount = data.count || 0;
                        if (submissionCount >= MAX_SUBMISSIONS_PER_DAY) {
                            rateLimitAlert.style.display = 'block';
                            submitBtn.disabled = true;
                        } else {
                            rateLimitAlert.style.display = 'none';
                            submitBtn.disabled = false;
                        }
                    } else {
                        // Reset count for new day
                        submissionCount = 0;
                        await docRef.set({
                            count: 0,
                            date: today
                        });
                        rateLimitAlert.style.display = 'none';
                        submitBtn.disabled = false;
                    }
                } else {
                    // First submission for this device
                    submissionCount = 0;
                    await docRef.set({
                        count: 0,
                        date: today
                    });
                    rateLimitAlert.style.display = 'none';
                    submitBtn.disabled = false;
                }
            } catch (error) {
                console.error("Error checking submission limit:", error);
                // Fallback - allow submission if there's an error
                submitBtn.disabled = false;
            }
        }

        // Record a new submission
        async function recordSubmission() {
            const deviceId = generateDeviceId();
            const today = new Date().toISOString().split('T')[0];
            
            try {
                const docRef = db.collection('submissions').doc(deviceId);
                await docRef.set({
                    count: submissionCount + 1,
                    date: today
                }, { merge: true });
                
                submissionCount++;
                if (submissionCount >= MAX_SUBMISSIONS_PER_DAY) {
                    rateLimitAlert.style.display = 'block';
                    submitBtn.disabled = true;
                }
            } catch (error) {
                console.error("Error recording submission:", error);
            }
        }

        // Filter sensitive information from text
        function filterSensitiveInfo(text) {
            // Filter phone numbers (more comprehensive)
            text = text.replace(/(?:\+?\d{1,3}[-.\s]?)?\(?\d{3}\)?[-.\s]?\d{3}[-.\s]?\d{4}/g, '[PHONE NUMBER REDACTED]');

            // Filter email addresses
            text = text.replace(/\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Z|a-z]{2,}\b/g, '[EMAIL REDACTED]');

            // Filter credit card numbers
            text = text.replace(/\b(?:\d[ -]*?){13,16}\b/g, '[CREDIT CARD REDACTED]');

            // Filter usernames (if they look like @username)
            text = text.replace(/@([a-zA-Z0-9_]+)/g, '[@USERNAME REDACTED]');

            // Filter common password-like strings (example: "password: mypass123")
            text = text.replace(/(password|sandi|kata sandi)\s*:\s*\S+/gi, '[PASSWORD REDACTED]');

            return text;
        }

        // Set language
        function setLanguage(lang) {
            currentLanguage = lang;
            const translation = translations[lang];
            
            // Update all translatable elements
            for (const [key, value] of Object.entries(translation)) {
                if (key === 'quickSolutions' || key === 'rateLimitInfo') continue;
                
                const element = document.getElementById(key);
                if (element) {
                    element.textContent = value;
                }
            }
            
            // Update quick solutions list
            const quickSolutionsList = document.getElementById('quickSolutions');
            quickSolutionsList.innerHTML = '';
            translation.quickSolutions.forEach(solution => {
                const li = document.createElement('li');
                li.textContent = solution;
                quickSolutionsList.appendChild(li);
            });
            
            // Update dropdown placeholders
            document.getElementById('selectPlatform').textContent = translation.selectPlatform;
            document.getElementById('selectIssue').textContent = translation.selectIssue;
            
            // Update rate limit info
            rateLimitInfo.textContent = translation.rateLimitInfo;
            rateLimitAlert.textContent = translation.rateLimitMessage;
            successAlert.textContent = translation.successMessage;
            errorAlert.textContent = translation.errorMessage;
            
            // Update templates when platform changes
            updateTemplates();
            
            // Check submission limit
            checkSubmissionLimit();
        }

        // Update templates based on selected platform, issue type, and language
        function updateTemplates() {
            templateOptions.innerHTML = '';
            selectedTemplate = null;
            
            const platform = platformSelect.value;
            const issueType = issueTypeSelect.value;
            const language = currentLanguage;
            
            const templatesForPlatform = platformTemplates[platform];
            if (templatesForPlatform && templatesForPlatform[language]) {
                const template = templatesForPlatform[language][issueType];
                
                if (template) {
                    templateSection.style.display = 'block';
                    const templateDiv = document.createElement('div');
                    templateDiv.className = 'template-option';
                    templateDiv.innerHTML = `
                        <h4>${template.title}</h4>
                        <p>${template.description}</p>
                        <small>Expected response: ${template.responseTime}</small>
                    `;
                    
                    templateDiv.addEventListener('click', () => {
                        document.querySelectorAll('.template-option').forEach(opt => opt.classList.remove('selected-template'));
                        templateDiv.classList.add('selected-template');
                        selectedTemplate = template;
                        
                        const accountId = document.getElementById('accountId').value || '{accountId}';
                        const reportedAccountId = document.getElementById('reportedAccountId')?.value || '{reportedAccountId}';
                        const email = document.getElementById('email').value || '{email}';
                        
                        let filledContent = template.content
                            .replace(/{accountId}/g, accountId)
                            .replace(/{reportedAccountId}/g, reportedAccountId)
                            .replace(/{email}/g, email);
                            
                        issueDetails.value = filledContent;
                    });
                    
                    templateOptions.appendChild(templateDiv);
                } else {
                    templateSection.style.display = 'none';
                }
            } else {
                templateSection.style.display = 'none';
            }
        }

        // Handle file upload
        uploadArea.addEventListener('click', () => fileInput.click());
        fileInput.addEventListener('change', () => {
            if (fileInput.files.length > 0) {
                fileName.textContent = fileInput.files[0].name;
            } else {
                fileName.textContent = '';
            }
        });

        // Platform change event
        platformSelect.addEventListener('change', updateTemplates);

        // Issue type change event
        issueTypeSelect.addEventListener('change', (e) => {
            updateTemplates();
            const accountIdGroup = document.getElementById('accountId').parentElement;
            let reportedUserGroup = document.getElementById('reportedUserGroup');

            if (e.target.value === 'report_user') {
                // Hide user's own account ID field and show reported user's ID field
                accountIdGroup.style.display = 'none';
                document.getElementById('accountId').required = false;

                if (!reportedUserGroup) {
                    reportedUserGroup = document.createElement('div');
                    reportedUserGroup.className = 'form-group';
                    reportedUserGroup.id = 'reportedUserGroup';
                    reportedUserGroup.innerHTML = `
                        <label for="reportedAccountId" id="reportedAccountIdLabel">Reported User's ID/Number</label>
                        <input type="text" id="reportedAccountId" required placeholder="e.g., offending_user or +628987654321">
                    `;
                    // Insert after the issue type dropdown
                    issueTypeSelect.parentElement.insertAdjacentElement('afterend', reportedUserGroup);
                }
                reportedUserGroup.style.display = 'block';
                document.getElementById('reportedAccountId').required = true;

            } else {
                // Show user's own account ID field and hide reported user's ID field
                accountIdGroup.style.display = 'block';
                document.getElementById('accountId').required = true;

                if (reportedUserGroup) {
                    reportedUserGroup.style.display = 'none';
                    document.getElementById('reportedAccountId').required = false;
                }
            }
        });

        // Account ID or email change event (to update template placeholders)
        document.getElementById('accountId').addEventListener('input', () => {
            if (selectedTemplate) {
                const accountId = document.getElementById('accountId').value || '{accountId}';
                const email = document.getElementById('email').value || '{email}';
                
                let filledContent = selectedTemplate.content
                    .replace(/{accountId}/g, accountId)
                    .replace(/{email}/g, email);
                    
                issueDetails.value = filledContent;
            }
        });

        document.getElementById('email').addEventListener('input', () => {
            if (selectedTemplate) {
                const accountId = document.getElementById('accountId').value || '{accountId}';
                const email = document.getElementById('email').value || '{email}';
                
                let filledContent = selectedTemplate.content
                    .replace(/{accountId}/g, accountId)
                    .replace(/{email}/g, email);
                    
                issueDetails.value = filledContent;
            }
        });

        // Language change event
        languageSelect.addEventListener('change', (e) => {
            setLanguage(e.target.value);
        });

        // Form submission
        form.addEventListener('submit', async (e) => {
            e.preventDefault();
            
            // Validate form
            if (!form.checkValidity()) {
                form.reportValidity();
                return;
            }
            
            // Check submission limit
            if (submissionCount >= MAX_SUBMISSIONS_PER_DAY) {
                rateLimitAlert.style.display = 'block';
                return;
            }
            
            // Prepare data
            const formData = {
                platform: platformSelect.value,
                accountId: document.getElementById('accountId').value,
                issueType: issueTypeSelect.value,
                issueDetails: filterSensitiveInfo(issueDetails.value), // Filter sensitive info
                email: document.getElementById('email').value,
                language: currentLanguage,
                templateUsed: selectedTemplate ? selectedTemplate.title : 'Custom',
                deviceId: generateDeviceId(),
                timestamp: new Date().toISOString()
            };

            if (formData.issueType === 'report_user') {
                formData.reportedAccountId = document.getElementById('reportedAccountId').value;
            }
            
            // Show loading
            submitBtn.disabled = true;
            submitText.innerHTML = `<span class="loading"></span>${translations[currentLanguage].loadingText}`;
            
            try {
                // First save to Firestore for rate limiting and records
                await db.collection('reports').add(formData);
                
                // Then send email using EmailJS
                let emailSubject = `${formData.issueType} Request for ${formData.platform} Account (${formData.language})`;
                let emailMessage = `
                        Platform: ${formData.platform}
                        Account ID: [REDACTED]
                        Issue Type: ${formData.issueType}
                        Language: ${formData.language}
                        Template Used: ${formData.templateUsed}
                        
                        Details:
                        ${formData.issueDetails}
                        
                        User Email: [REDACTED]
                    `;

                if (formData.issueType === 'report_user') {
                    emailSubject = `User Report on ${formData.platform} (${formData.language})`;
                    emailMessage = `
                        Platform: ${formData.platform}
                        Reporter's Account ID: [REDACTED]
                        Reported User's Account ID: ${formData.reportedAccountId}
                        Issue Type: ${formData.issueType}
                        Language: ${formData.language}

                        Details:
                        ${formData.issueDetails}

                        Reporter's Email: [REDACTED]
                    `;
                }

                await emailjs.send('service_neq331o', 'template_bmjyull', {
                    to_email: platformEmails[formData.platform],
                    from_email: formData.email,
                    subject: emailSubject,
                    message: emailMessage,
                    reply_to: formData.email
                });
                
                // Record the submission
                await recordSubmission();
                
                // Show success
                successAlert.textContent = translations[currentLanguage].successMessage;
                successAlert.style.display = 'block';
                errorAlert.style.display = 'none';
                rateLimitAlert.style.display = 'none';
                form.reset();
                fileName.textContent = '';
                templateSection.style.display = 'none';
                selectedTemplate = null;
            } catch (error) {
                console.error('Error submitting report:', error);
                errorAlert.textContent = translations[currentLanguage].errorMessage;
                errorAlert.style.display = 'block';
                successAlert.style.display = 'none';
                rateLimitAlert.style.display = 'none';
            } finally {
                // Reset button
                submitBtn.disabled = false;
                submitText.textContent = translations[currentLanguage].submitText;
                
                // Hide alerts after 5 seconds
                setTimeout(() => {
                    successAlert.style.display = 'none';
                    errorAlert.style.display = 'none';
                }, 5000);
            }
        });

        // Initialize
        generateDeviceId();
        setLanguage(currentLanguage);
        checkSubmissionLimit();
    </script>
</body>
</html>